as.character(aux_line$variable[i])
for(i in 1:nrow(aux_line)){
var_temp = as.character(aux_line$variable[i])
if(any(var_temp == grupo_1)){
aux_line$Grupo[i] == '1'
}
else if(any(var_temp == grupo_2)){
aux_line$Grupo[i] == '2'
}
else if(any(var_temp == grupo_3)){
aux_line$Grupo[i] == '3'
}
}
colnames(or_capital)
var_temp == grupo_3
any(var_temp == grupo_3)
for(i in 1:nrow(aux_line)){
var_temp = as.character(aux_line$variable[i])
if(any(var_temp == grupo_1)){
aux_line$Grupo[i] = '1'
}
else if(any(var_temp == grupo_2)){
aux_line$Grupo[i] = '2'
}
else if(any(var_temp == grupo_3)){
aux_line$Grupo[i] = '3'
}
}
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~.)
aux_line = filter(aux_line, -Grupo == NA)
aux_line = filter(aux_line, Grupo != NA)
aux_line = or_capital%>%
select(-c(ano:regiao_ssp))%>%
melt(id = 'data')
aux_line$Grupo = NA
grupo_1 = c('homicidio_doloso', 'homicidio_doloso_por_acidente_de_transito',
'homicidio_culposo_por_acidente_de_transito', 'homicidio_culposo_outros',
'tentativa_de_homicidio', 'lesao_corporal_seguida_de_morte', 'latrocinio')
grupo_2 = colnames(or_capital)[c(13:15, 18:20)]
grupo_3 = colnames(or_capital)[c(22:27)]
for(i in 1:nrow(aux_line)){
var_temp = as.character(aux_line$variable[i])
if(any(var_temp == grupo_1)){
aux_line$Grupo[i] = '1'
}
else if(any(var_temp == grupo_2)){
aux_line$Grupo[i] = '2'
}
else if(any(var_temp == grupo_3)){
aux_line$Grupo[i] = '3'
}
}
aux_line = filter(aux_line, grupo %in% c('1', '2', '3'))
aux_line = filter(aux_line, Grupo %in% c('1', '2', '3'))
View(aux_line)
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~.)
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_brewer(palette="Dark2")
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_brewer(palette="Dark2")
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_brewer(palette="Dark")
install.packages('wesanderson')
library(wesanderson)
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual(values=wes_palette(n=20, name="GrandBudapest"))
wes_palettes
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual(values=wes_palette(n=20, name="GrandBudapest1"))
getPalette = colorRampPalette(brewer.pal(20, "Set1"))
library(RColorBrewer)
getPalette = colorRampPalette(brewer.pal(20, "Set1"))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual()
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual(values = getPalette(20))
getPalette = colorRampPalette(brewer.pal(9, "BrBG"))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual(values = getPalette(20))
getPalette = colorRampPalette(brewer.pal(2, "BrBG"))
getPalette = colorRampPalette(brewer.pal(3, "BrBG"))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual(values = getPalette(20))
getPalette = colorRampPalette(brewer.pal(7, "BrBG"))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual(values = getPalette(20))
getPalette = colorRampPalette(brewer.pal(7, "Set3"))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')+
scale_color_manual(values = getPalette(20))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line() +facet_grid(Grupo ~., scales = 'free')
aux_line = or_capital%>%
select(-c(ano:regiao_ssp))%>%
melt(id = 'data')
colnames(or_capital)
aux_line = or_capital%>%
select(homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
getPalette = colorRampPalette(brewer.pal(7, "Set3"))
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
aux_line = or_capital%>%
select(homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
aux_line = or_capital%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
colnames(or_capital)
aux_line = or_capital%>%
select(data,lesao_corporal_seguida_de_morte:
lesao_corporal_culposa_outras)%>%
melt(id = 'data')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
aux_line = or_capital%>%
select(data,lesao_corporal_seguida_de_morte:
lesao_corporal_culposa_outras, total_de_estupro:estupro_de_vulneravel)%>%
melt(id = 'data')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
aux_line = or_capital%>%
select(data,roubo_outros:furto_de_veiculo)%>%
melt(id = 'data')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
load("~/PUCRIO/Verão/Estatística/Projeto/.RData")
aux_line = or_capital%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
library("basedosdados")
library(tidyverse)
library(zoo)
library("reshape2")
set_billing_id("projeto-ciencia-de-dados-2022")
aux_line = or_capital%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
p_homicidios = ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
p_homicidios
aux_line = or_capital%>%
select(data,lesao_corporal_seguida_de_morte:
lesao_corporal_culposa_outras)%>%
melt(id = 'data')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
aux_line = or_capital%>%
select(data,lesao_corporal_seguida_de_morte:
lesao_corporal_culposa_outras)%>%
melt(id = 'data')
ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
p_homicidios
library(sf)
library(geobr)
library(ggplot2)
library("basedosdados")
library(tidyverse)
library(zoo)
library("reshape2")
library(sf)
library(geobr)
library(ggplot2)
set_billing_id("projeto-ciencia-de-dados-2022")
sp_mun <- read_municipality(code_muni=35, year=2018)
or_mapa = OR %>%
colnames()[3] = 'code_muni'
or_mapa = OR
colnames(or_mapa)[3] = 'code_muni'
or_mapa = merge(sp_mun, OR)
colnames(or_mapa)
View(or_mapa)
View(sp_mun)
sp_mun$code_muni = as.character(sp_mun$code_muni)
or_mapa = merge(sp_mun, OR)
sp_mun <- read_municipality(code_muni=35, year=2018)
set_billing_id("projeto-ciencia-de-dados-2022")
query <- bdplyr("br_sp_gov_ssp.ocorrencias_registradas")
OR <- bd_collect(query)
colnames(OR)[3] = 'code_muni'
a = merge(sp_mun, OR)
OR <- bd_collect(query)
or_mapa = OR
or_mapa = OR
colnames(or_mapa)[3] = 'code_muni'
a = merge(sp_mun, or_mapa)
query <- bdplyr("br_sp_gov_ssp.ocorrencias_registradas")
OR <- bd_collect(query)
query <- bdplyr("br_sp_gov_ssp.produtividade_policial")
PP <- bd_collect(query)
OR$data <- as.yearmon(paste(OR$ano, OR$mes), "%Y %m")
PP$data <- as.yearmon(paste(PP$ano, PP$mes), "%Y %m")
sp_mun <- read_municipality(code_muni=35, year=2018)
or_mapa = OR
colnames(or_mapa)[3] = 'code_muni'
or_mapa = merge(sp_mun, OR)
query <- bdplyr("br_sp_gov_ssp.ocorrencias_registradas")
OR <- bd_collect(query)
query <- bdplyr("br_sp_gov_ssp.produtividade_policial")
PP <- bd_collect(query)
sp_mun <- read_municipality(code_muni=35, year=2018)
or_mapa = OR
colnames(or_mapa)[3] = 'code_muni'
or_mapa = merge(sp_mun, OR)
View(or_mapa)
View(sp_mun)
query <- bdplyr("br_sp_gov_ssp.ocorrencias_registradas")
OR <- bd_collect(query)
colnames(OR)[3] = 'code_muni'
a = merge(sp_mun, OR)
View(a)
View(OR)
colnames(or_mapa)[3] = 'code_muni'
library("basedosdados")
library(tidyverse)
library(zoo)
library("reshape2")
library(sf)
library(geobr)
library(ggplot2)
set_billing_id("projeto-ciencia-de-dados-2022")
query <- bdplyr("br_sp_gov_ssp.ocorrencias_registradas")
query <- bdplyr("br_sp_gov_ssp.ocorrencias_registradas")
OR <- bd_collect(query)
query <- bdplyr("br_sp_gov_ssp.produtividade_policial")
PP <- bd_collect(query)
sp_mun <- read_municipality(code_muni=35, year=2018)
colnames(or_mapa)[3] = 'code_muni'
or_mapa = left_join(OR, sp_mun)
or_mapa = left_join(or_mapa, sp_mun)
or_mapa$code_muni = as.numeric(or_mapa$code_muni)
or_mapa = left_join(or_mapa, sp_mun)
or_mapa = filter(or_mapa, ano %in% c(2008,2012,2016,2020), mes == 2)%>%
filter( !regiao_ssp %in% c('Capital', 'Grande São Paulo (exclui a Capital)' ))
or_mapa = OR
colnames(or_mapa)[3] = 'code_muni'
or_mapa$code_muni = as.numeric(or_mapa$code_muni)
or_mapa = left_join(or_mapa, sp_mun)
or_mapa = filter(or_mapa, ano %in% c(2008,2012,2016,2020), mes == 2)
or_mapa = filter(or_mapa, ano %in% c(2008,2012,2016,2020), mes == 2)
ggplot()+
geom_sf(data = or_mapa, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
or_mapa = OR
colnames(or_mapa)[3] = 'code_muni'
or_mapa$code_muni = as.numeric(or_mapa$code_muni)
or_mapa = filter(or_mapa, ano %in% c(2008,2012,2016,2020), mes == 2)
or_mapa = left_join(or_mapa, sp_mun)
ggplot()+
geom_sf(data = or_mapa, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
class(or_mapa)
or_mapa = left_join(or_mapa, sp_mun) %>% sf::st_as_sf()
ggplot()+
geom_sf(data = or_mapa, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
ggplot()+
geom_sf(data = or_mapa, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
ggplot()+
geom_sf(data = or_mapa, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
or_mapa_semsp = or_mapa %>%
filter( !regiao_ssp %in% c('Capital', 'Grande São Paulo (exclui a Capital)' ))
ggplot()+
geom_sf(data = or_mapa_semsp, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
pp_mapa = PP
sp_mun$code_muni = as.character(sp_mun$code_muni)
pp_mapa
pp_mapa = left_join(pp_mapa, sp_mun, by = c('code_muni' = 'id_municipio'))
sp_mun$code_muni = as.character(sp_mun$code_muni)
pp_mapa = left_join(pp_mapa, sp_mun, by = c('code_muni' = 'id_municipio'))
is.character(sp_mun$code_muni)
is.character(pp_mapa$id_municipio)
pp_mapa = left_join(pp_mapa, sp_mun, by = c('id_municipio' = 'code_muni' ))
pr_mapa = filter(pr_mapa, ano %in% c(2008,2012,2016,2020), mes == 2)%>%
sf::st_as_sf()
pp_mapa = left_join(pp_mapa, sp_mun, by = c('id_municipio' = 'code_muni' ))
pp_mapa = filter(pp_mapa, ano %in% c(2008,2012,2016,2020), mes == 2)%>%
sf::st_as_sf()
#vendo mapa sp p/ PP
pp_mapa = PP
sp_mun$code_muni = as.character(sp_mun$code_muni)
pp_mapa = left_join(pp_mapa, sp_mun, by = c('id_municipio' = 'code_muni' ))
pp_mapa = filter(pp_mapa, ano %in% c(2008,2012,2016,2020), mes == 2)%>%
sf::st_as_sf()
View(pp_mapa)
ggplot()+
geom_sf(data = pp_mapa, aes(fill= total_de_inqueritos_policiais_instalados),
alpha=0.8,col="white")+
facet_wrap(~ano)
colnames(pp_mapa)
ggplot()+
geom_sf(data = pp_mapa, aes(fill=total_de_inqueritos_policiais_instaurados),
alpha=0.8,col="white")+
facet_wrap(~ano)
ggplot()+
geom_sf(data = pp_mapa, aes(fill=total_de_inqueritos_policiais_instaurados),
alpha=0.8,col="white")+
facet_wrap(~ano)
ggplot()+
geom_sf(data = pp_mapa, aes(fill=total_de_inqueritos_policiais_instaurados),
alpha=0.8,col="white")+
facet_wrap(~ano)
pp_mapa_semsp = pp_mapa %>%
filter( !regiao_ssp %in% c('Capital', 'Grande São Paulo (exclui a Capital)' ))
ggplot()+
geom_sf(data = pp_mapa_semsp, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
ggplot()+
geom_sf(data = pp_mapa_semsp, aes(fill= total_de_inqueritos_policiais_instaurados)
,alpha=0.8,col="white")+
facet_wrap(~ano)
or_mapa = OR
colnames(or_mapa)[3] = 'code_muni'
or_mapa$code_muni = as.numeric(or_mapa$code_muni)
or_mapa = filter(or_mapa, ano %in% c(2008,2012,2016,2020), mes == 8)
or_mapa = left_join(or_mapa, sp_mun) %>% sf::st_as_sf()
or_mapa = OR%>%
filter(ano %in% c(2008,2012,2016,2020), mes == 8)%>%
left_join(sp_mun) %>% sf::st_as_sf()
or_mapa = OR%>%
filter(ano %in% c(2008,2012,2016,2020), mes == 8)%>%
left_join(sp_mun, by = c('id_municipio' = 'code_muni')) %>% sf::st_as_sf()
ggplot()+
geom_sf(data = or_mapa, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
or_mapa_semsp = or_mapa %>%
filter( !regiao_ssp %in% c('Capital', 'Grande São Paulo (exclui a Capital)' ))
ggplot()+
geom_sf(data = or_mapa_semsp, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
#vendo mapa sp p/ PP
pp_mapa = PP%>%
filter(ano %in% c(2008,2012,2016,2020), mes == 8)%>%
left_join(sp_mun, by = c('id_municipio' = 'code_muni')) %>% sf::st_as_sf()
ggplot()+
geom_sf(data = pp_mapa, aes(fill=total_de_inqueritos_policiais_instaurados),
alpha=0.8,col="white")+
facet_wrap(~ano)
pp_mapa_semsp = pp_mapa %>%
filter( !regiao_ssp %in% c('Capital', 'Grande São Paulo (exclui a Capital)' ))
ggplot()+
geom_sf(data = pp_mapa_semsp, aes(fill= total_de_inqueritos_policiais_instaurados)
,alpha=0.8,col="white")+
facet_wrap(~ano)
OR$data <- as.yearmon(paste(OR$ano, OR$mes), "%Y %m")
PP$data <- as.yearmon(paste(PP$ano, PP$mes), "%Y %m")
or_capital = OR %>%
filter(id_municipio == '3550308')
or_other  = OR %>%
filter(id_municipio != '3550308')
aux_line = or_capital%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
p_homicidios = ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
p_homicidios
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
p_homicidios = ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
p_homicidios
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variábel', 'Valor', -regiao_ssp, -data)
View(aux_line)
View(or_other)
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variável', 'Valor', -regiao_ssp, -data)
aux_line %>%
group_by(regiao_ssp)%>%
ggplot(aes(x=data, y=Valor, colour=Variável)) +
geom_line()
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variável', 'Valor', -regiao_ssp, -data) %>%
mutate(`Variável de interesse` = paste0(regiao_spp, 'Variável'))
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variável', 'Valor', -regiao_ssp, -data) %>%
mutate(`Variável de interesse` = paste(regiao_spp, 'Variável'))
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variável', 'Valor', -regiao_ssp, -data) %>%
mutate(`Variável de interesse` = paste(regiao_ssp, 'Variável'))
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variável', 'Valor', -regiao_ssp, -data) %>%
mutate(`Variável de interesse` = paste(regiao_ssp, Variável))
aux_line %>%
ggplot(aes(x=data, y=Valor, color = `Variável de interesse`)) +
geom_line()
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variável', 'Valor', -regiao_ssp, -data)
aux_line %>%
filter(Variável = 'homicidio_doloso')
aux_line %>%
filter(Variável == 'homicidio_doloso')
aux_line %>%
filter(Variável == 'homicidio_doloso')%>%
ggplot(aes(x=data, y=Valor, color = `Variável de interesse`)) +
geom_line()
aux_line %>%
filter(Variável == 'homicidio_doloso')%>%
ggplot(aes(x=data, y=Valor, color = regiao_ssp)) +
geom_line()
aux_line = or_other%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio, regiao_ssp)%>%
gather(key = 'Variável', 'Valor', homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)
View(aux_line)
View(or_other)
View(pp_mapa)
ggplot()+
geom_sf(data = pp_mapa, aes(fill=total_de_inqueritos_policiais_instaurados),
alpha=0.8,col="white")+
facet_wrap(~ano)
or_mapa_semsp = or_mapa %>%
filter( !regiao_ssp %in% c('Capital', 'Grande São Paulo (exclui a Capital)' ))
ggplot()+
geom_sf(data = or_mapa_semsp, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
ggplot()+
geom_sf(data = or_mapa, aes(fill= furto_outros),alpha=0.8,col="white")+
facet_wrap(~ano)
aux_line = or_capital%>%
select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
lesao_corporal_seguida_de_morte,latrocinio)%>%
melt(id = 'data')
p_homicidios = ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
p_homicidios
aux_line = or_capital%>%
select(data, furto_outros)%>%
melt(id = 'data')
p_homicidios = ggplot(data=aux_line,
aes(x=data, y=value, colour=variable)) +
geom_line()
p_homicidios
library(sidrar)
a= info_sidra()
a= info_sidra('População')
a= info_sidra('população')
a= info_sidra('populacao')
