library("basedosdados")
library(tidyverse)
library(zoo)
library("reshape2")
set_billing_id("projeto-ciencia-de-dados-2022")

query <- bdplyr("br_sp_gov_ssp.ocorrencias_registradas")
OR <- bd_collect(query)
query <- bdplyr("br_sp_gov_ssp.produtividade_policial")
PP <- bd_collect(query)

OR$data <- as.yearmon(paste(OR$ano, OR$mes), "%Y %m")
PP$data <- as.yearmon(paste(PP$ano, PP$mes), "%Y %m")


or_capital = OR %>%
  filter(id_municipio == '3550308')
or_other  = OR %>%
  filter(id_municipio != '3550308')


aux_line = or_capital%>%
  select(data, homicidio_doloso, homicidio_culposo_outros, tentativa_de_homicidio,
         lesao_corporal_seguida_de_morte,latrocinio)%>%
  melt(id = 'data')


p_homicidios = ggplot(data=aux_line,
       aes(x=data, y=value, colour=variable)) +
  geom_line()

aux_line = or_capital%>%
  select(data,lesao_corporal_seguida_de_morte:
           lesao_corporal_culposa_outras)%>%
  melt(id = 'data')

ggplot(data=aux_line,
       aes(x=data, y=value, colour=variable)) +
  geom_line()

aux_line = or_capital%>%
  select(data,roubo_outros:furto_de_veiculo)%>%
  melt(id = 'data')

ggplot(data=aux_line,
       aes(x=data, y=value, colour=variable)) +
  geom_line()




